<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vote & Results - Gender Reveal Party</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‘¶ğŸ»</text></svg>">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Quicksand', 'Nunito', Arial, sans-serif; }
    .cute-card { box-shadow: 0 2px 16px 0 rgba(0,0,0,0.10); border-radius: 1.5rem; transition: box-shadow 0.2s; }
    .emoji-bounce { animation: bounce 1s infinite alternate; }
    @keyframes bounce { 0% { transform: translateY(0); } 100% { transform: translateY(-8px); } }
    .pill-badge { display: inline-block; background: #f3f4f6; border-radius: 9999px; padding: 0.25rem 0.75rem; margin: 0.15rem; font-size: 1rem; font-weight: 600; }
    .pill-boy { background: #dbeafe; color: #2563eb; }
    .pill-girl { background: #fce7f3; color: #db2777; }
    .confetti { animation: confetti-fall 1.2s ease-in; }
    @keyframes confetti-fall { 0% { transform: translateY(-40px) scale(0.8); opacity: 0; } 100% { transform: translateY(0) scale(1); opacity: 1; } }
    
    /* Vote Animation Styles */
    .vote-notification {
      animation: voteSlideIn 0.8s ease-out forwards;
      transform: translateX(-100%);
    }
    @keyframes voteSlideIn {
      0% { transform: translateX(-100%); opacity: 0; }
      20% { transform: translateX(0); opacity: 1; }
      80% { transform: translateX(0); opacity: 1; }
      100% { transform: translateX(-100%); opacity: 0; }
    }
    .vote-bounce-in {
      animation: voteBounceIn 0.6s ease-out;
    }
    @keyframes voteBounceIn {
      0% { transform: scale(0.3) rotate(-10deg); opacity: 0; }
      50% { transform: scale(1.1) rotate(5deg); }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    .vote-pulse {
      animation: votePulse 0.8s ease-in-out;
    }
    @keyframes votePulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    /* Admin Mode Party Display Styles */
    .admin-results {
      background: linear-gradient(135deg, #fdf2f8 0%, #dbeafe 100%);
      border: 2px solid #fbbf24;
      box-shadow: 0 8px 32px rgba(251, 191, 36, 0.3);
    }
    .admin-results h2 {
      background: linear-gradient(90deg, #f59e0b, #ec4899);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .celebration-bar {
      background: linear-gradient(90deg, #3b82f6, #8b5cf6);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }
    .celebration-bar-girl {
      background: linear-gradient(90deg, #ec4899, #f59e0b);
      box-shadow: 0 4px 12px rgba(236, 72, 153, 0.4);
    }
    
    /* Party Display Mode Styles */
    .party-display-mode {
      transform: scale(1.2);
      margin: 2rem 0;
    }
    
    .party-display-mode h2 {
      font-size: 2.5rem !important;
      margin-bottom: 1.5rem !important;
    }
    
    .party-display-mode .flex.items-center {
      margin-bottom: 1.5rem !important;
    }
    
    .party-display-mode .w-full.bg-blue-100,
    .party-display-mode .w-full.bg-pink-100 {
      height: 3rem !important;
      border-radius: 1.5rem !important;
    }
    
    .party-display-mode .bg-blue-400,
    .party-display-mode .bg-pink-400 {
      height: 3rem !important;
      border-radius: 1.5rem !important;
    }
    
    .party-display-mode .text-2xl {
      font-size: 2rem !important;
    }
    
    .party-display-mode .text-blue-700,
    .party-display-mode .text-pink-700 {
      font-size: 1.5rem !important;
      font-weight: bold !important;
    }
    
    .party-display-mode .max-h-24 {
      max-height: 8rem !important;
      font-size: 1.2rem !important;
      padding: 1rem !important;
    }
    
    .party-display-mode #revealGenderBtn {
      font-size: 1.5rem !important;
      padding: 1rem 2rem !important;
      margin-top: 2rem !important;
    }
    
    /* Fullscreen Layout Styles */
    .fullscreen-layout {
      min-height: 100vh !important;
      background: linear-gradient(135deg, #fdf2f8 0%, #dbeafe 50%, #fef3c7 100%) !important;
      padding: 2rem !important;
      display: flex !important;
      flex-direction: column !important;
      justify-content: center !important;
      align-items: center !important;
      overflow-y: auto !important;
    }
    
    .fullscreen-layout .w-full.max-w-6xl {
      max-width: min(1200px, 85vw) !important;
      width: 100% !important;
      background: rgba(255, 255, 255, 0.95) !important;
      backdrop-filter: blur(10px) !important;
      border-radius: 2rem !important;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1) !important;
      padding: 2rem !important;
      margin: auto !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    /* Fullscreen Results Container */
    .fullscreen-layout .party-display-mode {
      transform: none !important;
      margin: 0 !important;
      width: 100% !important;
      max-width: 800px !important;
      margin: 0 auto !important;
      display: flex !important;
      flex-direction: column !important;
      gap: 1.5rem !important;
    }
    
    .fullscreen-layout .party-display-mode h2 {
      font-size: clamp(2rem, 5vw, 3.5rem) !important;
      margin-bottom: 1rem !important;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1) !important;
      text-align: center !important;
    }
    
    /* Vote Bars Styling */
    .fullscreen-layout .party-display-mode .mb-4 {
      width: 100% !important;
      display: flex !important;
      flex-direction: column !important;
      gap: 1.5rem !important;
      margin: 1rem 0 !important;
    }
    
    .fullscreen-layout .party-display-mode .flex.items-center {
      margin-bottom: 1rem !important;
      width: 100% !important;
      display: flex !important;
      align-items: center !important;
      gap: 1rem !important;
    }
    
    .fullscreen-layout .party-display-mode .w-full.bg-blue-100,
    .fullscreen-layout .party-display-mode .w-full.bg-pink-100 {
      height: clamp(2.5rem, 4vw, 3.5rem) !important;
      border-radius: 2rem !important;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
      flex: 1 !important;
      min-width: 0 !important;
    }
    
    .fullscreen-layout .party-display-mode .bg-blue-400,
    .fullscreen-layout .party-display-mode .bg-pink-400 {
      height: clamp(2.5rem, 4vw, 3.5rem) !important;
      border-radius: 2rem !important;
      transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }
    
    .fullscreen-layout .party-display-mode .text-2xl {
      font-size: clamp(1.5rem, 3vw, 2.5rem) !important;
      flex-shrink: 0 !important;
    }
    
    .fullscreen-layout .party-display-mode .text-blue-700,
    .fullscreen-layout .party-display-mode .text-pink-700 {
      font-size: clamp(1.25rem, 2.5vw, 2rem) !important;
      font-weight: bold !important;
      padding-left: 1rem !important;
    }
    
    /* Name Lists Styling */
    .fullscreen-layout .party-display-mode .max-h-24 {
      max-height: clamp(6rem, 12vh, 10rem) !important;
      font-size: clamp(1rem, 1.5vw, 1.4rem) !important;
      padding: 1rem !important;
      border-radius: 1rem !important;
      overflow-y: auto !important;
      width: 100% !important;
      margin-bottom: 1rem !important;
    }
    
    /* Create side-by-side layout for name lists in fullscreen */
    .fullscreen-layout .party-display-mode .mb-4 {
      display: flex !important;
      flex-direction: column !important;
      gap: 1rem !important;
    }
    
    .fullscreen-layout .party-display-mode .mb-4 > .max-h-24 {
      width: calc(50% - 0.5rem) !important;
      display: inline-block !important;
      vertical-align: top !important;
    }
    
    .fullscreen-layout .party-display-mode .mb-4 > .max-h-24:first-of-type {
      margin-right: 1rem !important;
    }
    
    /* Reveal Button Styling */
    .fullscreen-layout .party-display-mode #revealGenderBtn {
      font-size: clamp(1.25rem, 2.5vw, 2rem) !important;
      padding: clamp(0.75rem, 1.5vw, 1.25rem) clamp(1.5rem, 3vw, 2.5rem) !important;
      margin: 2rem auto 0 !important;
      border-radius: 1.5rem !important;
      box-shadow: 0 8px 24px rgba(251, 191, 36, 0.4) !important;
      animation: pulse-glow 2s infinite !important;
      max-width: 300px !important;
      width: auto !important;
      display: block !important;
    }
    
    /* Mobile Responsive */
    @media (max-width: 768px) {
      .fullscreen-layout {
        padding: 1rem !important;
      }
      
      .fullscreen-layout .w-full.max-w-6xl {
        max-width: 95vw !important;
        padding: 1.5rem !important;
      }
      
      .fullscreen-results-container {
        gap: 1.5rem !important;
      }
      
      .fullscreen-layout .party-display-mode {
        gap: 1rem !important;
      }
      
      .fullscreen-layout .names-container {
        grid-template-columns: 1fr !important;
        gap: 0.75rem !important;
      }
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 8px 24px rgba(251, 191, 36, 0.4); }
      50% { box-shadow: 0 8px 32px rgba(251, 191, 36, 0.6); }
    }
    
    /* Floating Confetti Animation */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10;
      overflow: hidden;
    }
    
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
      border-radius: 50%;
      animation: confetti-fall 3s linear infinite;
    }
    
    @keyframes confetti-fall {
      0% {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }
    
    /* Vote Bar Animation */
    .vote-bar-animate {
      animation: vote-bar-bounce 0.6s ease-out;
    }
    
    @keyframes vote-bar-bounce {
      0% { transform: scaleX(0.8); }
      50% { transform: scaleX(1.1); }
      100% { transform: scaleX(1); }
    }
    
    /* Floating Controls for Fullscreen */
    .floating-controls {
      position: fixed;
      top: 2rem;
      right: 2rem;
      z-index: 50;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    .floating-controls button {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(0, 0, 0, 0.1);
      border-radius: 1rem;
      padding: 0.75rem 1rem;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .floating-controls button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    }
    
    /* Media Query for Large Screens */
    @media (min-width: 1200px) {
      .large-screen-layout {
        min-height: 100vh !important;
        background: linear-gradient(135deg, #fdf2f8 0%, #dbeafe 50%, #fef3c7 100%) !important;
        padding: 2rem !important;
        display: flex !important;
        flex-direction: column !important;
        justify-content: center !important;
        align-items: center !important;
      }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-pink-100 to-blue-100 min-h-screen flex flex-col items-center justify-center">
  <div id="langSwitcher" class="absolute top-4 right-4 z-50">
    <button data-lang="en" class="lang-btn px-3 py-1 rounded-full font-bold bg-white bg-opacity-80 text-blue-700 mr-1">EN</button>
    <button data-lang="zh" class="lang-btn px-3 py-1 rounded-full font-bold bg-white bg-opacity-80 text-pink-700">ç¹é«”</button>
  </div>
  <div class="w-full max-w-md mx-auto p-4 bg-white cute-card text-center mt-4">
    <div id="partyInfo" class="mb-4">
      <div class="text-3xl mb-2 emoji-bounce">ğŸˆğŸ‘¶ğŸ»</div>
      <h1 id="partyName" class="text-2xl font-extrabold mb-1" data-i18n="partyNameTitle">Party Name</h1>
    </div>
    <div id="nameSection" class="mb-4">
      <div class="text-lg mb-2"><span data-i18n="whatsYourName">ğŸ‘‹ <span class="font-bold">What's your name?</span></span></div>
      <input id="guestName" type="text" placeholder="Enter your name" class="w-full px-4 py-3 border-2 border-blue-200 rounded-xl mb-2 text-lg" />
      <button id="submitNameBtn" class="w-full bg-blue-400 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-xl transition-all" data-i18n="continue">Continue</button>
      <div id="nameError" class="text-red-500 text-sm mt-1"></div>
    </div>
    <div id="voteSection" class="hidden">
      <div class="text-lg mb-2" data-i18n="whoDoYouThink">Who do you think it is?</div>
      <div class="flex flex-col sm:flex-row justify-center gap-4 mb-6 w-full">
        <button id="voteBoyBtn" class="flex-1 bg-blue-400 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-full text-lg transition-all emoji-bounce" data-i18n="boy">Boy ğŸ’™</button>
        <button id="voteGirlBtn" class="flex-1 bg-pink-400 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-full text-lg transition-all emoji-bounce" data-i18n="girl">Girl ğŸ’–</button>
      </div>
      <div id="voteMsg" class="text-green-600 font-semibold"></div>
    </div>
    <div id="resultsSection" class="hidden mt-6">
      <h2 class="text-lg font-bold mb-2" data-i18n="liveResults">Live Results <span class="text-2xl">ğŸ‰</span></h2>
      <div class="mb-4">
        <div class="flex items-center mb-2">
          <span class="text-blue-500 text-2xl mr-2">ğŸ’™</span>
          <div class="w-full bg-blue-100 rounded h-8 flex items-center relative overflow-hidden">
            <div id="boyBar" class="bg-blue-400 h-8 rounded-l transition-all duration-700 ease-in-out absolute left-0 top-0" style="width:0%"></div>
            <span id="boyCount" class="ml-2 text-blue-700 font-bold relative z-10 pl-2"></span>
          </div>
        </div>
        <div class="max-h-24 overflow-y-auto mb-2 bg-blue-50 rounded p-2 text-left" id="boyNames"></div>
        <div class="flex items-center mb-2">
          <span class="text-pink-500 text-2xl mr-2">ğŸ’–</span>
          <div class="w-full bg-pink-100 rounded h-8 flex items-center relative overflow-hidden">
            <div id="girlBar" class="bg-pink-400 h-8 rounded-l transition-all duration-700 ease-in-out absolute left-0 top-0" style="width:0%"></div>
            <span id="girlCount" class="ml-2 text-pink-700 font-bold relative z-10 pl-2"></span>
          </div>
        </div>
        <div class="max-h-24 overflow-y-auto bg-pink-50 rounded p-2 text-left" id="girlNames"></div>
      </div>
      <button id="revealGenderBtn" class="hidden bg-yellow-400 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-xl mb-4" data-i18n="revealGender">Reveal Gender</button>
    </div>
  </div>
  <div id="changePopup" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-6 rounded-2xl shadow-lg text-center">
      <p class="mb-4 font-bold">You can only change your vote once. Are you sure?</p>
      <button id="confirmChangeBtn" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-xl mr-2">Yes, change</button>
      <button id="cancelChangeBtn" class="bg-gray-400 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-xl">Cancel</button>
    </div>
  </div>
  <div id="revealPopup" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-6 rounded-2xl shadow-lg text-center">
      <p class="mb-4 font-bold">Are you sure you want to reveal the gender? This cannot be undone.</p>
      <button id="confirmRevealBtn" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-xl mr-2">Yes, reveal</button>
      <button id="cancelRevealBtn" class="bg-gray-400 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-xl">Cancel</button>
    </div>
  </div>
  <!-- F11 Fullscreen Instruction Popup (Admin Only) -->
  <div id="fullscreenPopup" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-8 rounded-2xl shadow-2xl text-center max-w-md mx-4">
      <div class="text-4xl mb-4">ğŸ–¥ï¸ğŸ“º</div>
      <h2 class="text-2xl font-bold mb-4" data-i18n="fullscreenTitle">Perfect for Party Display!</h2>
      <p class="mb-4 text-gray-700" data-i18n="fullscreenDesc">Press <span class="font-bold bg-yellow-100 px-2 py-1 rounded">F11</span> to enter fullscreen mode for the best party experience!</p>
      <div class="mb-4 p-3 bg-blue-50 rounded-lg">
        <p class="text-sm text-blue-800" data-i18n="fullscreenTip">ğŸ’¡ Tip: This works great on TVs, projectors, and large screens!</p>
      </div>
      <button id="closeFullscreenPopup" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl transition-all" data-i18n="gotIt">Got it!</button>
    </div>
  </div>

  <!-- Vote Animation Container -->
  <div id="voteAnimationContainer" class="fixed top-4 left-4 z-40 pointer-events-none"></div>

  <div id="finalReveal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-8 rounded-2xl shadow-2xl text-center">
      <h2 id="finalRevealMsg" class="text-4xl font-extrabold mb-4"></h2>
      <div id="finalConfetti" class="text-5xl confetti"></div>
    </div>
  </div>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="../../js/qrcode.min.js"></script>
  <script type="module" src="../../config/firebaseConfig.js"></script>
  <script type="module" src="../../js/vote_results.js"></script>
  <script type="module">
    import { TRANSLATIONS } from '../../config/translations.js';
    
    // Language switching logic
    const langBtns = document.querySelectorAll('.lang-btn');
    const i18nEls = document.querySelectorAll('[data-i18n]');
    
    function setLang(lang) {
      localStorage.setItem('lang', lang);
      const t = TRANSLATIONS[lang] || TRANSLATIONS['en'];
      i18nEls.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (t[key]) el.innerHTML = t[key];
      });
      langBtns.forEach(btn => {
        if (btn.getAttribute('data-lang') === lang) {
          btn.classList.add('ring-2', 'ring-pink-400');
        } else {
          btn.classList.remove('ring-2', 'ring-pink-400');
        }
      });
    }
    
    langBtns.forEach(btn => {
      btn.addEventListener('click', () => setLang(btn.getAttribute('data-lang')));
    });
    
    setLang(localStorage.getItem('lang') || 'en');
  </script>
</body>
</html> 